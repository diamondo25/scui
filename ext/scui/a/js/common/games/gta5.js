define("hbs!common/templates/common/advert",["hbs","common/hbs/handlebars"],function(e,t){var a=t.template(function(e,t,a){this.compilerInfo=[4,">= 1.0.0"],a=this.merge(a,e.helpers);var s,o,n="",r="function",l=this.escapeExpression;return n+='<li>\r\n    <a href="#" class="',(o=a.ClickClass)?s=o.call(t,{hash:{}}):(o=t&&t.ClickClass,s=typeof o===r?o.call(t,{hash:{}}):o),n+=l(s)+'" data-action="',(o=a.ActionData)?s=o.call(t,{hash:{}}):(o=t&&t.ActionData,s=typeof o===r?o.call(t,{hash:{}}):o),n+=l(s)+'" data-title="',(o=a.LinkText)?s=o.call(t,{hash:{}}):(o=t&&t.LinkText,s=typeof o===r?o.call(t,{hash:{}}):o),n+=l(s)+'">\r\n        <img src="',(o=a.ImageUrl)?s=o.call(t,{hash:{}}):(o=t&&t.ImageUrl,s=typeof o===r?o.call(t,{hash:{}}):o),n+=l(s)+'" />\r\n        <div>\r\n            <h2>',(o=a.Title)?s=o.call(t,{hash:{}}):(o=t&&t.Title,s=typeof o===r?o.call(t,{hash:{}}):o),n+=l(s)+"</h2>\r\n            <h3>",(o=a.Body)?s=o.call(t,{hash:{}}):(o=t&&t.Body,s=typeof o===r?o.call(t,{hash:{}}):o),n+=l(s)+"</h3>\r\n        </div>\r\n    </a>\r\n</li>"});return a}),define("common/games/gta5",["jquery","common/xhr","utils","underscore","setup.environment","setup.environment.utils","common/datafunctions","common/games/gamecommon","common/modals/modal-views","common/store/store-views","am","hbs!common/templates/common/advert"],function(e,t,a,s,o,n,r,l,i,c,d,m){function g(){var t=new e.Deferred;if(a.isStoreV2Enabled()){var s=function(){t.resolve(!0)},o=function(){t.resolve(!1)},n=function(){t.reject()},r={ofAgeCallbkFn:s,underAgeCallbkFn:o,errorCallbkFn:n};a.pubsub.trigger("setupEnvUtils:checkStoreAgeAppropriate",r)}return t.promise()}function u(e){switch(e){case E.FIND_CREW:case E.GO_TO_URL:case E.NONE:return!1;case E.STORE_WITH_SEARCH:case E.STORE_WITH_CATEGORY:default:return!0}}function h(e){switch(e){case E.STORE_WITH_SEARCH:return"clickEvent storeWithSearch";case E.STORE_WITH_CATEGORY:return"clickEvent storeWithCategory";case E.FIND_CREW:return"clickEvent goToFindCrew";case E.GO_TO_URL:return"clickEvent goToUrl";case E.NONE:return"clickEvent none";default:return"clickEvent storeDefault"}}function f(t){t.off("click","a.storeWithSearch").on("click","a.storeWithSearch",function(){d.trackEvent(d.category.advert,d.action.advert_storeWithSearch);var t=e("#storeButton");t.removeData(),t.data("productId",e(this).data("action")),c.showCommerceV2()}),t.off("click","a.storeWithCategory").on("click","a.storeWithCategory",function(){d.trackEvent(d.category.advert,d.action.advert_storeWithCategory);var t=e("#storeButton");t.removeData(),t.data("category",e(this).data("action")),c.showCommerceV2()}),t.off("click","a.storeDefault").on("click","a.storeDefault",function(){d.trackEvent(d.category.advert,d.action.advert_storeDefault),c.showCommerceV2()}),t.off("click","a.goToFindCrew").on("click","a.goToFindCrew",function(){d.trackEvent(d.category.advert,d.action.advert_findCrew),o.showCrewSearch(e(this).data("action"))}),t.off("click","a.goToUrl").on("click","a.goToUrl",function(){d.trackEvent(d.category.advert,d.action.advert_goToUrl);var t=e(this).data("action"),a=e(this).data("title");if(n.isUrlWhitelisted(t)){var s=n.getText("LinkConfirm","HomeSignin").replace("[linkText]",a);i.ShowConfirmModal(s,"","setupEnvUtils:launchExternalBrowserForUrl",t)}})}function v(){if(0===S){var t=e("#featuredPromotion"),a=1e4;S=setInterval(function(){if(!t.find("li").length||1===t.find("li").length||!n.isActivePanel("#homefeedPanel"))return void T();var e=t.find("li:visible"),a=e.next();0===a.length&&(a=t.find("li:eq(0)")),e.fadeOut(1e3),a.fadeIn(1e3)},a)}}function p(t){t.find("img").on("error",function(){k(e(this))})}function k(t){t.parents("li").remove();var a=e("#featuredPromotion").find("li");a.length?1===a.length?(a.show(),T()):(a.first().show(),T(),v()):(e("#featuredPromotion").hide(),T())}function T(){clearInterval(S),S=0}function b(){y.statsCache={}}function C(){b(),globals.adsLoaded=!1,e("#featuredPromotion").hide()}var y={};y.statsCache={};var S=0;y.GetLauncherConfig=function(){return{images:["images/gta5/launcher/img1.jpg","images/gta5/launcher/img2.jpg","images/gta5/launcher/img3.jpg","images/gta5/launcher/img4.jpg","images/gta5/launcher/img5.jpg","images/gta5/launcher/img6.jpg","images/gta5/launcher/img7.jpg","images/gta5/launcher/img8.jpg","images/gta5/launcher/img9.jpg","images/gta5/launcher/img10.jpg","images/gta5/launcher/img11.jpg","images/gta5/launcher/img12.jpg","images/gta5/launcher/img13.jpg","images/gta5/launcher/img14.jpg","images/gta5/launcher/img15.jpg","images/gta5/launcher/img16.jpg","images/gta5/launcher/img17.jpg","images/gta5/launcher/img18.jpg"],imgInterval:5e3}},y.LoadHomeScreen=function(){l.LoadHomeScreen(),globals.advertsEnabled&&(globals.adsLoaded?v():y.loadAds())},y.displayGameLogo=function(){e("#launcherLogo").length||e("#launcherStyleContent").prepend(e("<img>",{id:"launcherLogo",src:globals.baseUrl+"images/gta5/gtav_logo.png",alt:"Grand Theft Auto V"}))},y.loadAds=function(){var e=n.getCredsAsync();e.done(function(e){if(e.Ticket){var s='{ "playerTicket":"'+e.Ticket+'","env":"'+globals.rosEnvironment+'","title":"'+globals.titleName+'","version":'+globals.RosTitleVersion+'" }',o=n.GetAuthHeaderAsync(e.Ticket);o.done(function(e){var o=a.getApiUrl("api/"+globals.titleName+"/GetAdverts"),n=t.ajax({type:"POST",data:s,headers:e,async:!0,url:o,dataType:"json",silentFail:!0});n.done(function(e,t){"success"===t&&(y.renderAdverts(e),globals.adsLoaded=!0)})})}})},y.renderAdverts=function(t){var s=t.totalAdCount,o=t.adverts;if(0!==s&&null!==o&&"undefined"!=typeof o&&o.length){var n=e("#featuredPromotion"),r="",l=g();l.done(function(t){for(var l=0;l<o.length;l++){var i=o[l],c=i.languages[globals.titlelang];"undefined"==typeof c&&(c=i.languages["en-US"]);var d;d="undefined"!=typeof c.actionData&&null!==c.actionData&&""!==c.actionData?c.actionData:i.actionData;var g="";i.clickAction===E.GO_TO_URL&&(g="undefined"!=typeof c.linkText&&null!==c.linkText&&""!==c.linkText?c.linkText:d);var k=h(i.clickAction),T={ImageUrl:i.imageUrl,Title:c.title,Body:c.body,ClickClass:k,ActionData:d,LinkText:g};(t||!u(i.clickAction))&&(r+=a.renderCompiledTemplate(m,T))}n.find("ul").html(r),r.length&&(p(n),f(n),n.find("li:gt(0)").hide(),s>0&&o.length>1&&v(n),e("#featuredPromotion").fadeIn(1e3))})}};var E={STORE_WITH_SEARCH:0,STORE_WITH_CATEGORY:1,FIND_CREW:2,GO_TO_URL:3,NONE:4};y.LoadPlayerStats=function(s,o){a.WriteDebugLog("LoadPlayerStats","compareRockstarId",s);var n=o?"/OnlineStats":"/Stats",r=globals.baseAssetUrl+"xml/"+globals.titleName+n+globals.titlelang+".xml";t.ajax({type:"GET",async:!1,url:r,dataType:"xml",misc:{compareId:s,onlineStats:o},success:function(t){var a=[];e(t).find("id").each(function(){a.push(e(this).text())});var s=this.misc.compareId,o=this.misc.onlineStats;y.GetPlayerStatsJS(t,a.join(","),globals.account.RockstarId,s,o),t=null,a=null},complete:function(e,t){a.ToggleCompareFriendElements(t)}})};var x=function(t,a){n.resetScrollbar("#statsContainer"),n.removeLoading("statsPanel"),e("#awardsLink2").removeClass("disabled"),a?e("#statsLink2").removeClass("disabled"):e("#onlineStatsLink").removeClass("disabled"),"success"!==t&&e("#comparedFriend").hide()},A=function(t,a){return"success"===a&&"true"===e(t).find("Status").text()},I=function(t,s,o,r){var l,i,c=2;null!==s&&void 0!==s&&(e("#statsPanel").addClass("compared"),c=3);var d=e(t).find("StatsRecord");d.each(function(){e(this).find("GamerHandle").text()=="SC "+o?l=e(this).find("Values").text().split(","):i=e(this).find("Values").text().split(",")});var m=103,g=[],u="";e(r).find("id").each(function(t){var s=e(this),o="Conditional"==s.parent().attr("Comment"),r=s.parent().parent().find("header_name");r.length>0&&r.text()!=u&&(u=r.text(),g.length>0&&g.push("</tbody>"),g.push("<tbody id='"+u+"' class='statgroup' tabindex='"+m+"'><tr class='levelName statGroupHeader'><td colspan='"+c+"' class='levelName clearfix "+s.parent().parent()[0].nodeName+"'><div class='headerName'>"+u+"</div><span></span></td></tr>"),m++);var d=s.text();if(""!=d.length){var h=void 0!=l&&void 0!=l[t]?l[t]:"-";if(!o||o&&"0"!=h){var f="",v=s.parent().find("type");switch(v.text().toLowerCase()){case"duration":"-"!=h&&(h=a.msToTime(h)),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?a.msToTime(i[t]):"-")+"</td>");break;case"percentage":"-"!=h&&(h=a.formatPercent(h)),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?a.formatPercent(i[t]):"-")+"</td>");break;case"meterstomiles":"-"!=h&&(h=a.metersToMiles(h)),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?a.metersToMiles(i[t]):"-")+"</td>");break;case"meterstofeet":"-"!=h&&(h=a.metersToFeet(h)),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?a.metersToFeet(i[t]):"-")+"</td>");break;case"kphtomph":"-"!=h&&(h=a.kphToMph(h)),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?a.kphToMph(i[t]):"-")+"</td>");break;case"money":"-"!=h&&(h=a.formatMoney(h)),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?a.formatMoney(i[t]):"-")+"</td>");break;case"boolean":"-"!=h&&(h=0==h?n.getText("No","Social"):n.getText("Yes","Social")),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?0==i[t]?n.getText("No","Social"):n.getText("Yes","Social"):"-")+"</td>");break;case"meters":"-"!=h&&(h=a.formatMeters(h)),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?a.formatMeters(i[t]):"-")+"</td>");break;case"decimal":"-"!=h&&(h=a.decimal(h)),e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]&&"-"!=i[t]?a.decimal(i[t]):"-")+"</td>");break;default:e("#statsPanel").hasClass("compared")&&(f="<td class='col3'>"+(void 0!=i&&void 0!=i[t]?i[t]:"-")+"</td>")}var p=s.parent().find("name");p.length>0&&g.push("<tr style='display:none' id='statId"+d+"' class='"+s.parent().parent()[0].nodeName+"'><td class='col1'>"+p.text()+"</td>"+f+"<td class='col2'>"+h+"</td></tr>")}}}),g.length>0&&g.push("</tbody>"),e("#statstable").html(g.join("")),e("#statstable .statgroup").keydown(function(t){13==t.which&&e(this).click()}),e("#statstable .statgroup").click(function(){var t=e(this);return t.find("tr.levelName.statGroupHeader").toggleClass("open"),t.children(":not(.statGroupHeader)").toggle(),n.resetScrollbar("#statsPanel"),!1}),g=null,l=null,i=null},P=function(t,s,o,n,r){"success"==s&&("true"==e(t).find("Status").text()?I(t,o,n,r):a.WriteDebugLog("GetPlayerStatsJS","Status error",e(t).find("Error").text(),a.logType.error,a.logController[globals.titleName])),e("#checkName").fadeOut()};return y.GetPlayerStatsJS=function(s,o,r,l,c){var d=c?"getgtavonlineplayerstats":"getplayerstatsws",m=a.getApiUrl("api/"+globals.titleName+"/"+d),g=[globals.titleName,d,r,l?l:-1].join(":");if(y.statsCache[g]){var u=y.statsCache[g],h="success";return P(u,h,l,r,s),void x(h,c)}var f=n.getCredsAsync();f.done(function(d){if(d&&d.Ticket){var u='{ "env":"'+globals.rosEnvironment+'","title":"'+globals.titleName+'","version":'+globals.RosTitleVersion+', "wsURL":"'+globals.wsURL+'","platformId":'+globals.platformId+',"statIds":"'+o+'","rockstarIds":"'+r+(void 0!=l?","+l:"")+'" }';a.WriteDebugLog("GetPlayerStatsJS","options",u);var h=n.GetAuthHeaderAsync(d.Ticket);h.done(function(e){t.ajax({type:"POST",url:m,headers:e,data:u,contentType:"application/json; charset=utf-8",dataType:"xml",cache:!1,services:["stats"],fatalError:i.ShowErrorModal,requestDescription:"GetPlayerStats",misc:{xmlData:s,playerRockstarId:r,compareRockstarId:l,onlineStats:c},success:function(e,t){A(e,t)&&(y.statsCache[g]=e);var a=this.misc.xmlData,s=this.misc.playerRockstarId,o=this.misc.compareRockstarId;P(e,t,o,s,a)},complete:function(e,t){s=null,o=null,r=null,l=null;var a=this.misc.onlineStats;x(t,a)}})})}else n.removeLoading("statsPanel"),e("#statstable").html("<tr><td>"+n.getError("InternetAccess")+"</td></tr>")})},a.pubsub.on("section:stats:loaded",b),a.pubsub.on("signout:completed",C),y});